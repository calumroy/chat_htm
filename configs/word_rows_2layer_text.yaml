# Two-Layer Word-Row Text HTM Configuration
# Layer 0: word-row sensory layer (same as word_rows_text.yaml).
# Layer 1: abstraction layer with global receptive fields and aggressive
#           temporal pooling to build stable word-sequence representations.

text:
  mode: word_rows

encoder:
  letter_bits: 8
  alphabet: "abcdefghijklmnopqrstuvwxyz"

enable_feedback: false

layers:
  # Layer 0 - Sensory layer (one row per character position in the word)
  - name: Layer0_WordRows
    input:
      rows: 5
      cols: 216               # letter_bits * (26 + 1) = 216
    columns:
      rows: 5
      cols: 56
    overlap:
      pot_width: 216
      pot_height: 1
      center_pot_synapses: true
      connected_perm: 0.3
      min_overlap: 4
      min_potential_overlap: 1
      wrap_input: true
    inhibition:
      width: 36
      height: 1
      desired_local_activity: 2
      strict_local_activity: false
    spatial_learning:
      permanence_inc: 0.08
      permanence_dec: 0.04
      active_col_permanence_dec: 0.04
    sequence_memory:
      cells_per_column: 3
      max_segments_per_cell: 3
      max_synapses_per_segment: 12
      min_num_syn_threshold: 2
      new_syn_permanence: 0.3
      connect_permanence: 0.2
      activation_threshold: 7
      permanence_inc: 0.08
      permanence_dec: 0.04
    temporal_pooling:
      enabled: false
      delay_length: 1

  # Layer 1 - Abstraction layer with wide receptive fields over Layer 0.
  # pot_width covers the full column width (168) and pot_height covers all
  # 5 rows so every Layer 1 column can potentially connect to any Layer 0
  # column.  Temporal pooling is aggressive to build stable representations
  # that persist across words in a sentence.
  - name: Layer1_Abstraction
    columns:
      rows: 5
      cols: 40
    overlap:
      pot_width: 168
      pot_height: 5
      center_pot_synapses: true
      connected_perm: 0.3
      min_overlap: 3
      min_potential_overlap: 1
      wrap_input: true
    inhibition:
      width: 40
      height: 5
      desired_local_activity: 2
      strict_local_activity: false
    spatial_learning:
      permanence_inc: 0.06
      permanence_dec: 0.04
      active_col_permanence_dec: 0.04
    sequence_memory:
      cells_per_column: 4
      max_segments_per_cell: 6
      max_synapses_per_segment: 20
      min_num_syn_threshold: 3
      new_syn_permanence: 0.3
      connect_permanence: 0.2
      activation_threshold: 6
      permanence_inc: 0.06
      permanence_dec: 0.04
    temporal_pooling:
      enabled: true
      delay_length: 6
      spatial_permanence_inc: 0.3
      sequence_permanence_inc: 0.04
